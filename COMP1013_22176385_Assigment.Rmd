---
title: "COMP1013_22176385_Assigment"
output: word_document
date: "2025-05-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Identity

## Student Surname: Prema Santhi

## Student Firstname: I Gusti Ayu Agung

## Student ID: 22176385

## Unit Name: Analytics Programming

## Unit Number: COMP1013

# Dataset information
In this assigment, we use several provided datasets such as below:

1. customers.csv

2. geolocation.csv

3. order_items.csv

4. orders.csv

5. payments.csv

6. products.csv

7. sellers.csv

## Load all the dataset
Before begin to the analysis, load all the data first
```{r}
customer.data=read.csv("customers.csv")
geo.data=read.csv("geolocation.csv")
item.data=read.csv("order_items.csv")
orders=read.csv("orders.csv")
payment.data=read.csv("payments.csv")
product.data=read.csv("products.csv")
sellers.data=read.csv("sellers.csv")
```

## Call the necessery libraries
```{r, results='hide', message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
```

# Task 1
We are required to analyze the distribution of customers across different states. So in that case we will use customers data.

Use table to count the states from customer_state variable inside customer.data
```{r}
state.count=table(customer.data$customer_state)
```


Convert it into data frame. There are 2 reasons why to do so:

1. We can easily read or interpret data in the data frame format

2. To be able to use ggplot, the data should be in data frame
```{r}
state.count.df=as.data.frame(state.count)
colnames(state.count.df)=c("state_name", "count")
```

Now visualize the data
```{r}
ggplot(data=state.count.df)+
  geom_col(mapping=aes(x=state_name, y=count), fill="dark green")+
  labs(title="Distribution of customers across different states",
       y="Number of customers", x="states")+
  coord_flip()
```

The graph is messy and hard to understand. Even though we can immediately know the highest is SP, but it is better to read the graph by the order. So:
```{r}
## put (reorder) in the x axis
ggplot(data=state.count.df)+
  geom_col(mapping=aes(x=reorder(state_name, count), y=count), fill="dark green")+
  labs(title="Distribution of customers across different states",
       y="Number of customers", x="States")+
  coord_flip()
```

Since there are so many states name in that graph, we filter it into top 5 states with the most customers

```{r}
state.count.sorted=sort(state.count, decreasing=TRUE) #sort from the highest to the smallest
top5.states=state.count.sorted[1:5]
top5.states.df=as.data.frame(top5.states)
colnames(top5.states.df)=c("states","count")

ggplot(data=top5.states.df)+
  geom_col(mapping=aes(x=reorder(states, count), y=count), fill="dark green")+
  labs(title="the top 5 States with the most customers",
       y="Number of customers", x="states")+
  coord_flip()
```

From the graph above, we could see that SP state has the highest customers. It also create a big gap between the top 1 with top 2 (RJ state) which is around $30,000$
